import{_ as m,d as p,n as D,l as x,o as a,c as _,b as t,F as b,q as w,t as l,u as c,p as R,k as B,h as I,a as k,s as S,x as G,w as h,j as g,y as M,z as P,m as U}from"./index-cde09f8b.js";import{g as V,a as O}from"./index-71a875f6.js";import{_ as Q}from"./Button-10dfdbdc.js";import{b as j}from"./browser-e933942f.js";import{_ as L}from"./NavBar-4366b7c7.js";const q=o=>(R("data-v-5fdde75a"),o=o(),B(),o),A={class:"ticket-records"},E=q(()=>t("div",{class:"title"},[t("h2",{class:"tickstatus"},"票券紀錄")],-1)),J={class:"btm-box"},K={class:"form"},W=q(()=>t("thead",null,[t("tr",null,[t("th",null,"日期"),t("th",null,"狀態"),t("th",null,"票型"),t("th",null,"價格")])],-1)),X={__name:"TicketHistory",setup(o){const e=p();return D(()=>{x.get("/api/v1/userTickets/getTickets").then(n=>{e.value=n.data})}),(n,i)=>(a(),_("div",A,[E,t("section",J,[t("table",K,[W,t("tbody",null,[(a(!0),_(b,null,w(c(e),s=>(a(),_("tr",{key:s._id},[t("td",null,l(s.statusDate&&c(V)(s.statusDate)),1),t("td",null,l(s.status),1),t("td",null,l(s.ticketCategoryId.ticketType)+" "+l(s.ticketCategoryId.fastTrack?"快速通關":"一般票"),1),t("td",null,l(s.currentPurchasePrice)+"元",1)]))),128))])])])]))}},Y=m(X,[["__scopeId","data-v-5fdde75a"]]);const Z=["src"],tt={__name:"QRCodeGenerator",props:{id:String},setup(o){const e=o,n=p(""),i=async()=>{if(e.id.trim()==="")return;const s={width:100,height:100},v=await j.toDataURL(e.id,s);n.value=v};return D(()=>{i()}),(s,v)=>n.value?(a(),_("img",{key:0,src:n.value,alt:"QR Code"},null,8,Z)):I("",!0)}},F=m(tt,[["__scopeId","data-v-8b36f294"]]);const et={class:"ticket-box-content"},st={__name:"Tickets",props:["ticketData"],setup(o){const e=o;return(n,i)=>{const s=F;return a(),_("div",{class:"ticket-card",style:S({backgroundColor:c(O)(e.ticketData.status,e.ticketData.ticketCategoryId.ticketType)})},[t("div",et,[t("div",null,[t("p",null,l(e.ticketData.status==="used"?"已使用":"未使用"),1)]),t("h3",null,l(e.ticketData.ticketCategoryId.ticketType),1),t("h4",null,l(e.ticketData.ticketCategoryId.fastTrack?"快速通關":"一般票"),1)]),k(s,{id:e.ticketData._id},null,8,["id"])],4)}}},ot=m(st,[["__scopeId","data-v-295f1ec1"]]);const nt={key:0,class:"modal-overlay"},at={class:"box-content"},ct={class:"status"},lt={class:"ticketitle"},_t={key:0,class:"btn-wrap"},it={key:1,class:"btn-wrap"},rt={key:1,class:"refundPrice"},ut={__name:"TicketInfoRefundModal",props:{isOpen:Boolean,currentTicketData:Object},setup(o,{emit:e}){const n=o,i=p(!0),s=p(!0),v=()=>{i.value=!0,s.value=!0,e("close"),location.reload()},r=p(n.currentTicketData);G(()=>n.currentTicketData,d=>{r.value=d});function T(){i.value=!1,s.value=!1}const u=async()=>{x.get(`/api/v1/userTickets/refund/${r.value._id}`).then(d=>{console.log(d),e("close"),location.reload()}).catch(d=>{console.log(d)})};return(d,$)=>{const f=Q,C=F;return n.isOpen?(a(),_("div",nt,[t("div",{class:"card",style:S({backgroundColor:c(O)(c(r).status,c(r).ticketCategoryId.ticketType)})},[t("div",at,[t("div",ct,[t("p",null,l(c(r).status==="used"?"已使用":"未使用"),1)]),t("div",lt,l(c(r).ticketCategoryId.ticketType),1),t("h3",null,l(c(r).ticketCategoryId.fastTrack?"快速通關":"一般票"),1),c(s)?(a(),_("div",_t,[k(f,{btnFontSize:"0.5",onClick:v},{default:h(()=>[g("返回")]),_:1}),k(f,{class:"btn",btnColor:"rgba(0,0,0,0)",btnHoverColor:"none",onClick:T},{default:h(()=>[g("退票")]),_:1})])):(a(),_("div",it,[k(f,{btnFontSize:"0.5",onClick:v},{default:h(()=>[g("不想退票")]),_:1}),k(f,{class:"btn",btnColor:"rgba(0,0,0,0)",btnHoverColor:"none",onClick:u},{default:h(()=>[g("我想退票")]),_:1})]))]),c(i)?(a(),M(C,{key:0,id:c(r)._id,class:"qrcode"},null,8,["id"])):(a(),_("div",rt," 2000元 "))],4)])):I("",!0)}}},dt=m(ut,[["__scopeId","data-v-09013643"]]);const H=o=>(R("data-v-19880509"),o=o(),B(),o),pt={class:"title"},kt=H(()=>t("h2",null,"未使用",-1)),vt={class:"ticketBox"},ft={key:0,class:"noTicketBox"},ht=H(()=>t("h2",null,"目前沒有訂票",-1)),gt={__name:"userTicketView",setup(o){const e=p([]),n=p(!1),i=p(null),s=p(!1),v=P(()=>{if(e.value.length>0){const u=e.value[0];return V(u.ticketDate)}});D(async()=>{const u=await x.get("/api/v1/userTickets//getTickets");e.value=u.data,e.value.length===0?s.value=!0:s.value=!1});const r=u=>{u.status!=="used"&&(i.value=u,n.value=!0)};function T(){U.push("/user/cart")}return(u,d)=>{const $=L,f=dt,C=ot,N=Q,z=Y;return a(),_(b,null,[k($),k(f,{isOpen:n.value,onClose:d[0]||(d[0]=y=>n.value=!1),currentTicketData:i.value},null,8,["isOpen","currentTicketData"]),t("main",null,[t("div",pt,[kt,t("h3",null,l(c(v)),1)]),t("div",vt,[(a(!0),_(b,null,w(e.value,(y,mt)=>(a(),M(C,{key:y._id,ticketData:y,onClick:yt=>r(y)},null,8,["ticketData","onClick"]))),128)),s.value?(a(),_("div",ft,[ht,k(N,{onClick:T},{default:h(()=>[g("前往訂票頁面")]),_:1})])):I("",!0)]),k(z)])],64)}}},It=m(gt,[["__scopeId","data-v-19880509"]]);export{It as default};
